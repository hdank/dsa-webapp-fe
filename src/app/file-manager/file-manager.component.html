<div  class="block"><app-sidebar></app-sidebar></div>
<div class="page-container">
  <h2>Quáº£n lÃ½ tÃ i liá»‡u</h2>
  <!-- File Upload Section -->
  <div class="tools-container">
  <div>
    <button class="showBtn" (click)="showUpload()">ThÃªm tÃ i liá»‡u má»›i</button> <span class="sumaryCount">Tá»•ng cá»™ng :{{files.length}} tÃ i liá»‡u</span>
  </div>
  <div class="tools-searching">
    <input id="searchInp" type="text" placeholder="Search by keywords or ID">
    <button (click)="search()">
      ğŸ”
    </button>
  </div>
  </div>
  <div class="upload-container" *ngIf="role ==='admin'">
    <label class="upload-file-label">Chá»n file cáº§n táº£i lÃªn (khÃ´ng quÃ¡ 10MB):</label>
    <input
      id="uploadFileInp"
      type="file"
      (change)="onFileSelected($event)"
      class="block w-200 text-gray-900 border border-gray-300 rounded-lg cursor-pointer focus:outline-none focus:ring-2 focus:ring-blue-500"
    />
      <button *ngIf="role ==='admin'"
              (click)="uploadFile()"
              class="uploadBtn"
      >
        Táº£i lÃªn tÃ i liá»‡u
      </button>
  </div>
  <!-- Uploaded Files List -->
    <table class="table table-striped">
      <thead class="">
      <tr>
        <th scope="col">#</th>
        <th scope="col">ID</th>
        <th scope="col">TÃªn file</th>
        <th scope="col">Thá»i gian táº£i lÃªn</th>
        <th scope="col">Thao tÃ¡c</th>
      </tr>
      </thead>
      <tbody *ngIf="files.length > 0" class="">
      <tr *ngFor="let file of files.slice(pageStart,pageEnd); let i = index">
        <th scope="row">{{(currentPage-1)*pageSize+i+1}}</th>
        <td>{{ file.id }}</td>
        <td>{{ file.fileName }}</td>
        <td>{{ dateFormat(file.uploadTime) }}</td>
        <td>
          <button
            class="actionBtn"
            title="Xem file"
          >
            ğŸ—’
          </button>
          <button
            (click)="downloadFile(file.id, file.fileName)"
            class="actionBtn"
            title="Táº£i xuá»‘ng"
          >
            â¬‡ï¸
          </button>
          <button *ngIf="role ==='admin'"
                  (click)="deleteFile(file.id)"
                  class="actionBtn"
                  title="XÃ³a"
          >
            ğŸ—‘ï¸
          </button>
        </td>
      </tr>
      </tbody>
      <tbody *ngIf="files.length === 0">
        <tr>
          <td colspan="5" style="text-align: center">ChÆ°a cÃ³ tÃ i liá»‡u nÃ o Ä‘Æ°á»£c táº£i lÃªn.</td>
        </tr>
      </tbody>
    </table>
    <nav aria-label="Page navigation example">
      <ul class="pagination pagination-sm justify-content-end">
        <li class="page-item" [class.disabled]="currentPage === 1" (click)="currentPage === 1 ? null : navPage('-')"><a class="page-link">Trang trÆ°á»›c</a></li>
        <li *ngFor="let _ of totalPages; let i = index" class="page-item" [class.active]="i === 0" (click)="goToPage(i+1)"><a class="page-link">{{i+1}}</a></li>
        <li class="page-item" [class.disabled]="currentPage === totalPages.length" (click)="currentPage === totalPages.length ? null : navPage('+')"><a class="page-link">Trang sau</a></li>
      </ul>
    </nav>
  </div>
